---
output:
  html_notebook:
    toc: true
    toc_depth: 4
---


```{r include=FALSE}
library(MakroOEKB1115)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(latex2exp)
```

## Grunnleggende  bakgrunnkunnskaper

### Stabiliseringsmål for en åpen økonomi

- Intern balanse (lukke produksjonsgapet):

$$(Y-\overline{Y})=0$$

- Ekstern balanse (rimelig nivå på utenlandsgjelden - gjelden skal kunne betjenes uten problemer)

---

### Tre fundamentale endringer fra en lukket økonomi

#### (1) Handel med utlandet

$$AE \equiv C+I+G+NX$$
$NX$ er nå inkludert i definisjonen for aggregert etterspørsel

NX er definert som eksport $(EX)$ minus import $(R\cdot IM)$ målt i enheter av det innenlandske godet:

$$NX=EX−R\cdot IM \text{ }$$
Realvalutakursen $R=\frac{E\cdot P^{*}}{P}$ (prisforholdet mellom utenlandske og innenlandske goder målt i enheter av det innenlandske gode) sørger her for at alt blir målt i enheter av det innenlandske godet. 

---


#### (2) Fast eller flytende kurs

Renteparitetsbetingelsen

$$(1+i_{t+1})=(1+i_{t+1}^{*})\frac{E_{t+1}^{e}}{E_{t}}$$
Likevektsbetingelse som forteller oss at den forventede avkastningen er lik mellom å investere i inn- og utland.

Her er $i_{t+1}$ innelandsk avkastning, $i_{t+1}^{*}$ utenlands avkastning, $E_{t}$ er (nominelle) prisen i dag per énhet av utenlandsk valuta og $E_{t+1}^{e}$ den forventede valutakursen én periode frem i tid.  

---

#### (3) Utenriksregnskapet (BoP)

$$BP = CA + CU + OR=0$$

$CU=\text{Driftsregnskapet}$. 

Består av nettoeksport (NX), pluss nettofinansinntekter(aksjer og obligasjoner) og nettoverføringer

$CA=\text{Kapitalregnskapet}$ 

Nettoendringer i fordringer og gjeld ovenfor utlandet

$OR=\text{Endringer i sentralbankens valutareserver}$ 

Vil øke (reduseres) dersom fastkursprisen er svakere (sterkere) enn det som markedet er villig til å betale 

## Mundell-Fleming modellen

### Adferdsligninger

#### Husholdninger og bedrifter

Husholdningene import ($IM$) av utenlandske goder er gitt ved

$$IM=  -m_{1}R + m_{2}Y $$

Bedriftenes eksport ($EX$) av innenlandske goder er gitt ved

$$EX=x_{1}R + x_{2}Y^{*}  $$

---

Ved å sett inn for uttrykkene ovenfor, kan vi skrive nettoeksporten som  

$$NX = EX - R\cdot IM = x_{1}R + x_{2}Y^{*} - R\cdot (m_{1}R + m_{2}Y)$$

Legger til grunn i dette kurset at priseffekten dominerer innteksteffekten ([Marshall-Lerner betingelsen](https://en.wikipedia.org/wiki/Marshall%E2%80%93Lerner_condition)
):

$$\frac{\Delta NX}{\Delta R}= \underset{priseffekt}{x_{1}} - \underset{inntektseffekt}{IM} + \underset{priseffekt}{m_{1}R} > 0 \text{ (i praksis vil dette ta litt tid)}$$  

---

#### Offentlige myndigheter (instruering) og sentralbanken (implementering)

Myndighetene kan velge mellom fast eller flytende kurs:

- Fast
$$i =i^{*} + rp$$

Anser markedsaktørene faskursregimet som troverdig, har vi at $E=E^{e} \Rightarrow rp=0$

- Flytende 

$$E=\frac{(1+i^{*})}{(1+i)}E^{e}$$


```{r include=FALSE}
iv <- 0:5
openpar <- list(i_s=1.5, rp=0)
muflexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100,
                         P=1, h = 10, k =1, Y = 130, m=1, t=0.4), openpar, list(i=c(iv)))

eopenpar <- list(i_s=1.0, rp=0)
emuflexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 110,
                          P=1, h = 10, k =1, Y = 130, m=1, t=0.4), eopenpar, list(i=c(iv)))

seopenpar <- list(i_s=1.0, rp=0)
semuflexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 45, b = 10, oI = 10, T = 50, M= 110,
                          P=1, h = 10, k =1, Y = 130, m=1, t=0.4), eopenpar, list(i=c(iv)))

dfmufl <- dfgeneric(modell='islmo', exoparval = muflexoparvalv, eqsel = c(1,2))
edfmufl <- dfgeneric(modell='islmo', exoparval = emuflexoparvalv, eqsel = c(1,2))
sedfmufl <- dfgeneric(modell='islmo', exoparval = semuflexoparvalv, eqsel = c(1,2))

# Fast kurs
dfkurvermffast <- data.frame(kurve=c("IS", ""),
                             fargel = c('red', 'red'),
                             fargek = c('red', 'red'),
                             y = c(dfmufl$varnavnminverdi$value[c(1)], dfmufl$varnavnmaksverdi$value[c(2)]),
                             x = c(dfmufl$varnavnminverdi$Iv[c(1)],dfmufl$varnavnmaksverdi$Iv[c(2)]))

labelsmufl <- list(title = 'Mundell-Fleming modellen - fast kurs',
                   y = 'produksjon, inntekt (Y)',
                   x = 'rentenivå (i=i*+rp)',
                   x0 = c(TeX('$i_{0}}$')),
                   y0 = c(TeX('$Y_{0}$')),
                   kurver = dfkurvermffast)

muflfastlikevekt <- genmakrofigure(dfnumeric=dfmufl,
                                   variables = c(dfmufl$varnavn)[c(1)],
                                   labt = labelsmufl,
                                   scalejust = list(x=0, y=90))  + coord_flip() +
  geom_line(data=data.frame(x=dfmufl$yeae[1], y=90:165), aes(x,y), color ='black', size=0.5) +
  geom_text(aes(x=dfmufl$yeae[1], y=165+3 ,label='BoP'), color = 'red')

# Fast kurs, endring i utenlandsrenta
edfkurvermffast <- data.frame(kurve=c("IS", ""),
                              fargel = c('red', 'red'),
                              fargek = c('red', 'red'),
                              y = c(dfmufl$varnavnminverdi$value[c(1)], dfmufl$varnavnmaksverdi$value[c(2)]),
                              x = c(dfmufl$varnavnminverdi$Iv[c(1)],dfmufl$varnavnmaksverdi$Iv[c(2)]))

elabelsmufl <- list(title = 'Mundell-Fleming modellen - fast kurs',
                    y = 'produksjon, inntekt (Y)',
                    x = 'rentenivå (i=i*+rp)',
                    x0 = c(TeX('$i_{1}}$')),
                    y0 = c(TeX('$Y_{1}$')),
                    kurver = edfkurvermffast)

emuflfastlikevekt <- cgenmakrofigure(dfnumeric=dfmufl,
                                     edfnumeric=edfmufl,
                                     variables = c(dfmufl$varnavn)[c(1)],
                                     labt = labelsmufl,
                                     elabt = elabelsmufl,
                                     scalejust = list(x=0, y=75)) + coord_flip() +
  geom_line(data=data.frame(x=dfmufl$yeae[1], y=90:165), aes(x,y), color ='black', size=0.5) +
  geom_text(aes(x=dfmufl$yeae[1], y=165+3 ,label='BoP'), color = 'red') +
  geom_line(data=data.frame(x=edfmufl$yeae[1], y=90:165), aes(x,y), color ='black', size=0.5) +
  geom_text(aes(x=edfmufl$yeae[1], y=165+3 ,label="BoP'"), color = 'red')

emuflfastlikevekt



sedfkurvermffast <- data.frame(kurve=c("IS'", ""),
                              fargel = c('red', 'red'),
                              fargek = c('red', 'red'),
                              y = c(sedfmufl$varnavnminverdi$value[c(1)], sedfmufl$varnavnmaksverdi$value[c(2)]),
                              x = c(sedfmufl$varnavnminverdi$Iv[c(1)], sedfmufl$varnavnmaksverdi$Iv[c(2)]))

selabelsmufl <- list(title = 'Mundell-Fleming modellen - fast kurs',
                    y = 'produksjon, inntekt (Y)',
                    x = 'rentenivå (i=i*+rp)',
                    x0 = c(TeX('$i_{2}}$')),
                    y0 = c(TeX('$Y_{2}$')),
                    kurver = sedfkurvermffast)


semuflfastlikevekt <- cgenmakrofigure(dfnumeric=dfmufl,
                                     edfnumeric=sedfmufl,
                                     variables = c(dfmufl$varnavn)[c(1)],
                                     labt = labelsmufl,
                                     elabt = selabelsmufl,
                                     scalejust = list(x=0, y=75)) + coord_flip() +
  geom_line(data=data.frame(x=dfmufl$yeae[1], y=90:165), aes(x,y), color ='black', size=0.5) +
  geom_text(aes(x=dfmufl$yeae[1], y=165+3 ,label='BoP'), color = 'red') +
  geom_line(data=data.frame(x=edfmufl$yeae[1], y=90:165), aes(x,y), color ='black', size=0.5) +
  geom_text(aes(x=edfmufl$yeae[1], y=165+3 ,label="BoP'"), color = 'red')

semuflfastlikevekt

```

## Mundell-Fleming modellen under fast kurs
Viser den samtidige likevekten i gode-, penge- og valutakursmarkedet under fast kurs

### Godemarkedet

$$Y = \frac{1}{1-c(1-t) + R\cdot m_{2}}  \left [ \overline{C} + \overline{I} - b\cdot \overline{i} + \overline{G} + EX + R^{2}\cdot m_{1} \right]$$

### Pengemarkedet

$$kY -hi = \overline{M}/P$$

### Valutakursmarkedet
$$i =i^{*} + rp$$

---

**Formelt**

$$\frac{\Delta Y}{\Delta \overline{i}} =\left[\frac{-b}{1-c(1-t) + R\cdot m_{1}}\right ] 
< 0 \text{ :IS-kurven}$$

$$i =i^{*} + rp \text{ BoP-kurven}$$


**Grafisk**


```{r echo=FALSE, warning=FALSE}
muflfastlikevekt
```

---

### Komparativ statikk (skiftanalyse)

```{r echo=FALSE}
emuflfastlikevekt
```


---

### Stabiliseringspolitikk (G og T)

Eks. reduksjon i offentlig utgifter ($\overline{G}<0$)

```{r echo=FALSE}
semuflfastlikevekt
```

---

Merk: Under fast kurs er renta bundet til å holde fastkursen stabil, det gjør at finanspolitikk (endring i offentlige utgifter og skatter) står igjen som de eneste virkemidelene som kan stabillisere konjunkturbevegelsene.


## Mundell-Fleming modellen under flytende kurs
Viser den samtidige likevekten i gode-, penge- og valutakursmarkedet under flytende kurs.

```{r include=FALSE}
# Flytende kurs
iv <- 2:7.5
eopenpar <- list(i_s=1.5, rp=0.25, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0, Ee=1)
emuflexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100,
                         P=1, h = 10, k =1, Y = 130, m=1, t=0.4), eopenpar, list(i=c(iv)))

iv <- 2:7.5
eeopenpar <- list(i_s=1.0, rp=0, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0, Ee=1)
eemuflexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 75, b = 10, oI = 10, T = 50, M= 100,
                          P=1, h = 10, k =1, Y = 130, m=1, t=0.4), eeopenpar, list(i=c(iv)))

iv <- 2:7.5
eseopenpar <- list(i_s=1.0, rp=0, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0, Ee=1)
esemuflexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 75, b = 10, oI = 10, T = 50, M= 80,
                            P=1, h = 10, k =1, Y = 130, m=1, t=0.4), eeopenpar, list(i=c(iv)))

edfmufl <- dfgeneric(modell='islmo', exoparval = emuflexoparvalv, eqsel = c(3,4))
eedfmufl <- dfgeneric(modell='islmo', exoparval = eemuflexoparvalv, eqsel = c(3,4))
sedfmufl <- dfgeneric(modell='islmo', exoparval = esemuflexoparvalv, eqsel = c(3,4))


edfkurvermffast <- data.frame(kurve=c("IS-BoP", "LM"),
                             fargel = c('red', 'red'),
                             fargek = c('red', 'red'),
                             y = c(filter(edfmufl$varnavnminverdi, variable=='eisbpv')[,3], filter(edfmufl$varnavnmaksverdi, variable=='elmv')[,3]),
                             x = c(filter(edfmufl$varnavnminverdi, variable=='eisbpv')[,1], filter(edfmufl$varnavnmaksverdi, variable=='elmv')[,1]))

elabelsmufl <- list(title = 'Mundell-Fleming modellen - flytende kurs',
                   y = 'produksjon, inntekt (Y)',
                   x = 'rentenivå (i)',
                   x0 = c(TeX('$i_{0}}$')),
                   y0 = c(TeX('$Y_{0}$')),
                   kurver = edfkurvermffast)

edfmufl$yeae <- c(4.4,144)

muflflytendelikevekt <- genmakrofigure(dfnumeric=edfmufl,
                                       variables = c('eisbpv','elmv'),
                                       labt = elabelsmufl,
                                       scalejust = list(x=0, y=100))  + coord_flip()

muflflytendelikevekt

## Endring
edfkurvermffast <- data.frame(kurve=c("IS-BoP'", "LM"),
                              fargel = c('red', 'red'),
                              fargek = c('red', 'red'),
                              y = c(filter(eedfmufl$varnavnminverdi, variable=='eisbpv')[,3], filter(eedfmufl$varnavnmaksverdi, variable=='elmv')[,3]),
                              x = c(filter(eedfmufl$varnavnminverdi, variable=='eisbpv')[,1], filter(eedfmufl$varnavnmaksverdi, variable=='elmv')[,1]))

eelabelsmufl <- list(title = 'Mundell-Fleming modellen - flytende kurs',
                    y = 'produksjon, inntekt (Y)',
                    x = 'rentenivå (i=i*+rp)',
                    x0 = c(TeX('$i_{1}}$')),
                    y0 = c(TeX('$Y_{1}$')),
                    kurver = edfkurvermffast)

edfmufl$yeae <- c(4.4,144)
eedfmufl$yeae <- c(5.7, 157)

emuflfastlikevekt <- cgenmakrofigure(dfnumeric=edfmufl,
                                     edfnumeric=eedfmufl,
                                     variables = c('eisbpv','elmv'),
                                     labt = elabelsmufl,
                                     elabt = eelabelsmufl,
                                     scalejust = list(x=0, y=75)) + coord_flip()

emuflfastlikevekt

## Stabiliseringspolitkk
sedfkurvermffast <- data.frame(kurve=c("IS-BoP'", "LM'"),
                              fargel = c('red', 'red'),
                              fargek = c('red', 'red'),
                              y = c(filter(sedfmufl$varnavnminverdi, variable=='eisbpv')[,3], filter(sedfmufl$varnavnmaksverdi, variable=='elmv')[,3]),
                              x = c(filter(sedfmufl$varnavnminverdi, variable=='eisbpv')[,1], filter(sedfmufl$varnavnmaksverdi, variable=='elmv')[,1]))

seelabelsmufl <- list(title = 'Mundell-Fleming modellen - fast flytende kurs',
                     y = 'produksjon, inntekt (Y)',
                     x = 'rentenivå (i=i*+rp)',
                     x0 = c(TeX('$i_{1}}$')),
                     y0 = c(TeX('$Y_{1}$')),
                     kurver = sedfkurvermffast)

sedfmufl$yeae <- c(6.5, 144)

semuflfastlikevekt <- cgenmakrofigure(dfnumeric=edfmufl,
                                     edfnumeric=sedfmufl,
                                     variables = c('eisbpv','elmv'),
                                     labt = elabelsmufl,
                                     elabt = seelabelsmufl,
                                     scalejust = list(x=0, y=75)) + coord_flip()

semuflfastlikevekt

```


### Godemarkedet

$$Y = \frac{1}{1-c(1-t) + R\cdot m_{2}}  \left [ \overline{C} + \overline{I} - b\cdot \overline{i} + \overline{G} + EX + R\cdot m_{1} \right]$$

### Pengemarkedet

$$kY -hi = \overline{M}/P$$

### BP

$$E=\frac{(1+i^{*})}{(1+i)}E^{e}$$

---

**Formelt**

$$\underset{Flytende-kurs (IS-BoP-kurven)}{\frac{\Delta Y}{\Delta \overline{i}}} < \underset{Fast-kurs (IS-kurven)}{\frac{\Delta Y}{\Delta \overline{i}}}  =\left[\frac{-b}{1-c(1-t) + R\cdot m_{1}}\right ] 
< 0$$


**Grafisk**

Viser den samtidige likevekten i gode-, penge- og valutakursmarkedet (flytende kurs)

```{r echo=FALSE, warning=FALSE}
muflflytendelikevekt
```

---

### Komparativ statikk (skiftanalyse)

Økning i det utenlandske rentenivået ($i^{*}>0$)

```{r echo=FALSE}
emuflfastlikevekt
```


---

### Stabiliseringspolitikk  (M/(i), G og T) 

Eks. reduksjon i pengmengden ($\overline{M}<0$)

```{r echo=FALSE}
semuflfastlikevekt
```


### AD-AS modellen for en åpen økonomi

## AD- likningen under fast og flytende kurs

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
iv <- 0:4
openpar <- list(i_s=1.5, rp=0.25, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0,Ee=1)
islmoexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100,
                         P=1, h = 10, k =1, Y = 130, m=1, t=0.4), openpar, list(i=c(iv)))

eopenpar <- list(i_s=1.5, rp=0.25, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0,Ee=1)
eislmexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100,
                         P=0.75, h = 10, k =1, Y = 130, m=1, t=0.4), eopenpar, list(i=c(iv)))


dfislmo <- dfgeneric(modell='islmo', exoparval = islmoexoparvalv)
edfislmo <- dfgeneric(modell='islmo', exoparval = eislmexoparvalv)

# Fast kurs
idfkurverislmo <- data.frame(kurve=c("", "IS"),
                           fargel = c('red', 'red'),
                           fargek = c('red', 'red'),
                           y = c(filter(dfislmo$varnavnminverdi, variable=='ibpv')[,3], filter(dfislmo$varnavnminverdi, variable=='iisv')[,3]),
                           x = c(filter(dfislmo$varnavnminverdi, variable=='ibpv')[,1], filter(dfislmo$varnavnminverdi, variable=='iisv')[,1]))


ilabelsislm <- list(title = 'Mundell-Fleming modellen - fast kurs',
                    y = 'produksjon, inntekt (Y)',
                    x = 'rentenivå (i)',
                    x0 = c(TeX('$i_{0}}$')),
                    y0 = c(TeX('$Y_{0}$')),
                    kurver = idfkurverislmo)

eidfkurverislmo <- data.frame(kurve=c("", "IS'"),
                             fargel = c('red', 'red'),
                             fargek = c('red', 'red'),
                             y = c(filter(edfislmo$varnavnminverdi, variable=='ibpv')[,3], filter(edfislmo$varnavnminverdi, variable=='iisv')[,3]),
                             x = c(filter(edfislmo$varnavnminverdi, variable=='ibpv')[,1], filter(edfislmo$varnavnminverdi, variable=='iisv')[,1]))


eilabelsislm <- list(title = 'Mundell-Fleming modellen - flytende kurs',
                    y = 'produksjon, inntekt (Y)',
                    x = 'rentenivå (i)',
                    x0 = c(TeX('$i_{1}}$')),
                    y0 = c(TeX('$Y_{1}$')),
                    kurver = eidfkurverislmo)


islmochangepricei <- cgenmakrofigure(dfnumeric=dfislmo,
                                   edfnumeric=edfislmo,
                                   variables = c('iisv'),
                                   labt = ilabelsislm,
                                   elabt = eilabelsislm,
                                   scalejust = list(x=0, y=0),
                                   limits= list(x=NULL, y=c(150,250))) + coord_flip() +
  geom_line(data=data.frame(x=dfislmo$yeae[1], y=75:230), aes(x,y), color ='black', size=0.5) +
  geom_text(aes(x=dfislmo$yeae[1], y=240 ,label='BoP'), color = 'red')

islmochangepricei

# Flytende kurs
iv <- 1.5:10
openpar <- list(i_s=1.5, rp=0.25, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0,Ee=1)
islmoexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100,
                          P=1, h = 10, k =1, Y = 130, m=1, t=0.4), openpar, list(i=c(iv)))

eopenpar <- list(i_s=1.5, rp=0.25, E=1, Ps=1, x1=20, x2=0.1, m1=15, m2=0.1, Ys=200, rp=0,Ee=1)
eislmexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100,
                          P=0.75, h = 10, k =1, Y = 130, m=1, t=0.4), eopenpar, list(i=c(iv)))

dfislmo <- dfgeneric(modell='islmo', exoparval = islmoexoparvalv)
edfislmo <- dfgeneric(modell='islmo', exoparval = eislmexoparvalv)

edfkurverislmo <- data.frame(kurve=c("LM", "IS-BoP"),
                             fargel = c('red', 'red'),
                             fargek = c('red', 'red'),
                             y = c(filter(dfislmo$varnavnmaksverdi, variable=='elmv')[,3], filter(dfislmo$varnavnminverdi, variable=='eisbpv')[,3]),
                             x = c(filter(dfislmo$varnavnmaksverdi, variable=='elmv')[,1], filter(dfislmo$varnavnminverdi, variable=='eisbpv')[,1]))


elabelsislm <- list(title = 'Mundell-Fleming modellen - fast kurs',
                    y = 'produksjon, inntekt (Y)',
                    x = 'rentenivå (i)',
                    x0 = c(TeX('$i_{0}}$')),
                    y0 = c(TeX('$Y_{0}$')),
                    kurver = edfkurverislmo)

eedfkurverislmo <- data.frame(kurve=c("LM'", "IS-BoP'"),
                              fargel = c('red', 'red'),
                              fargek = c('red', 'red'),
                              y = c(filter(edfislmo$varnavnmaksverdi, variable=='elmv')[,3], filter(edfislmo$varnavnminverdi, variable=='eisbpv')[,3]),
                              x = c(filter(edfislmo$varnavnmaksverdi, variable=='elmv')[,1], filter(edfislmo$varnavnminverdi, variable=='eisbpv')[,1]))


eelabelsislm <- list(title = 'Mundell-Fleming modellen - fast kurs',
                     y = 'produksjon, inntekt (Y)',
                     x = 'rentenivå (i)',
                     x0 = c(TeX('$i_{1}}$')),
                     y0 = c(TeX('$Y_{1}$')),
                     kurver = eedfkurverislmo)


dfislmo$yeae <- c(4.75, 143)
edfislmo$yeae <- c(3, 175)


islmochangepricee <- cgenmakrofigure(dfnumeric=dfislmo,
                                    edfnumeric=edfislmo,
                                    variables = c('eisbpv','elmv'),
                                    labt = elabelsislm,
                                    elabt = eelabelsislm,
                                    scalejust = list(x=0, y=75),
                                    limits= list(x=NULL, y=NULL)) + coord_flip()
islmochangepricee








###################################
# AD-Kurven flytende kurs
Yv <- 100:200 # Guess
adasexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100, P=1, h = 10,
                         k =1),list(Pe=1, mu = 0.1, l_1=-20,l_2=1, z=1, A= 5,
                                    N=400, alpha = 1, Ac = 2), list(Y=c(Yv)))

dfadas <- dfgeneric(modell='adasl', exoparval = adasexoparvalv)

dfkurver = data.frame(kurve=c("AD"),
                      fargel = c('red'),
                      fargek = c('red'),
                      x = dfadas$varnavnmaksverdi$Iv[1],
                      y = dfadas$varnavnmaksverdi$value[1])

labelsadas <- list(title = 'AD-kurven',
                   x = 'produksjon, inntekt (Y)',
                   y = 'prisnivå (P)',
                   x0 = c(TeX('$Y_{0$'), TeX('$Y_{1}$')),
                   y0 = c(TeX('$P_{0}$'), TeX('$P_{1}$')),
                   kurver = dfkurver)


#dfadas$yeae <- c(dfislm$yeae[2], edfislm$yeae[2], 1, 0.75)

adaslikevekt <- genmakrofigure(dfnumeric = dfadas,
                               variables = c(dfadas$varnavn[1]),
                               labt = labelsadas,
                               scalejust = list(x=100, y=0),
                               punktvelger = list(x=c(1,2), y=c(3,4)))

grid.arrange(islmochangepricei, islmochangepricee, adaslikevekt, adaslikevekt, nrow=2)
```


#### Samtidig likevekt

```{r echo=FALSE}
library(MakroOEKB1115)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(latex2exp)
# AD-AS likevekt
###########################################################################################################
Yv <- 105:125 # Guess
adasexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 10, T = 50, M= 100, P=1, h = 10,
                         k =1),list(Pe=1, mu = 2, l_1=-5,l_2=1, z=1, A= 1,
                                    N=400, alpha = 1, Ac = 4), list(Y=c(Yv)))

dfadas <- dfgeneric(modell='adasl', exoparval = adasexoparvalv)

subset(dfadas$dfmodell, variable = 'asv')

dfkurver = data.frame(kurve=c("AD", "AS"),
                    fargel = c('red', 'red'),
                    fargek = c('red', 'red'),
                    x = dfadas$varnavnmaksverdi$Iv,
                    y = dfadas$varnavnmaksverdi$value)

labelsadas <- list(title = 'AD-AS modellen',
                   x = 'produksjon, inntekt (Y)',
                   y = 'prisnivå (P)',
                   x0 = c(TeX('$Y_{0}=Y^{N}$')),
                   y0 = c(TeX('$P_{0}$')),
                   kurver = dfkurver)

adaslikevekt <- genmakrofigure(dfnumeric=dfadas,
                      variables = c(dfadas$varnavn),
                      labt = labelsadas,
                      scalejust = list(x=100, y=0.5))

adaslikevekt
```


#### Komparativ statikk (skiftanalyse)
```{r}
## AD-AS komparativ statikk (skiftanalyse)
# ###########################################################################################################
# ### Kort sikt
eYv <- 105:125 # Guess
eiadasexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 30, T = 50, M= 100, P=1, h = 10,
                         k =1),list(Pe=1, mu = 2, l_1=-5,l_2=1, z=1, A= 1,
                                    N=400, alpha = 1, Ac = 4), list(Y=c(eYv)))
eksdfadas <- dfgeneric(modell='adasl', exoparval = eiadasexoparvalv)

edfkurver = data.frame(kurve=c("AD'", "AS"),
                       fargel = c('red', 'red'),
                       fargek = c('red', 'red'),
                       x = eksdfadas$varnavnmaksverdi$Iv,
                       y = eksdfadas$varnavnmaksverdi$value)

elabelsadas <- list(title = 'AD-AS modellen',
                   x = 'produksjon, inntekt (Y)',
                   y = 'prisnivå (P)',
                   x0 = c(TeX('$Y_{1}$')),
                   y0 = c(TeX('$P_{1}$')),
                   kurver = edfkurver)

eksadaslikevekt <- cgenmakrofigure(dfnumeric=dfadas,
                                   edfnumeric=eksdfadas,
                                   variables = c(dfadas$varnavn),
                                   labt = labelsadas,
                                   elabt = elabelsadas,
                                   scalejust = list(x=110, y=0))

#### Mellomlang sikt ###
Yv <- 105:125 # Guess
eiadasexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 30, T = 50, M= 100, P=1, h = 10,
                           k =1),list(Pe=1.3425, mu = 2, l_1=-5,l_2=1, z=1, A= 1,
                                      N=400, alpha = 1, Ac = 4), list(Y=c(eYv)))

emsdfadas <- dfgeneric(modell='adasl', exoparval = eiadasexoparvalv)

emdfkurver = data.frame(kurve=c("AD'", "AS''"),
                       fargel = c('red', 'red'),
                       fargek = c('red', 'red'),
                       x = emsdfadas$varnavnmaksverdi$Iv,
                       y = emsdfadas$varnavnmaksverdi$value)

elabelsadas <- list(title = 'AD-AS modellen',
                    x = 'produksjon, inntekt (Y)',
                    y = 'prisnivå (P)',
                    x0 = c(TeX('$$')),
                    y0 = c(TeX('$P_{2}$')),
                    kurver = emdfkurver)

labelsadas <- list(title = 'AD-AS modellen',
                   x = 'produksjon, inntekt (Y)',
                   y = 'prisnivå (P)',
                   x0 = c(TeX('$Y_{0}=$Y_{2}=Y^{N}$')),
                   y0 = c(TeX('$P_{0}$')),
                   kurver = dfkurver)

emsadaslikevekt <- cgenmakrofigure(dfnumeric=dfadas,
                                   edfnumeric=emsdfadas,
                                   variables = c(dfadas$varnavn),
                                   labt = labelsadas,
                                   elabt = elabelsadas,
                                   scalejust = list(x=100, y=0)) + geom_line(data=data.frame(x=dfadas$yeae[1], y=0:3), aes(x,y), color ='black', size=0.5) + geom_text(aes(x=110, y= 3,label='LAS'), color = 'red')

emsadaslikevekt
```


#### Stabiliseringspolitikk 
- Finanspolitikk
- Pengepolitikk

```{r}
# ## AD-AS stabiliseringspolitikk
# ###########################################################################################################
Yv <- 105:125 # Guess
stadasexoparvalv <- c(list(c_1 = 0.6, oC = 50, oG= 50, b = 10, oI = 30, T = 50, M= 100, P=1, h = 10,
                           k =1),list(Pe=1, mu = 2, l_1=-5,l_2=1, z=1, A= 1,
                                      N=400, alpha = 1, Ac = 4), list(Y=c(eYv)))

stdfadas <- dfgeneric(modell='adasl', exoparval = stadasexoparvalv)

sdfkurver = data.frame(kurve=c("AD'", "AS"),
                       fargel = c('red', 'red'),
                       fargek = c('red', 'red'),
                       x = stdfadas$varnavnmaksverdi$Iv,
                       y = stdfadas$varnavnmaksverdi$value)

ldfkurver = data.frame(kurve=c("AD=AD''", "AS"),
                       fargel = c('red', 'red'),
                       fargek = c('red', 'red'),
                       x = dfadas$varnavnmaksverdi$Iv,
                       y = dfadas$varnavnmaksverdi$value)

llabelsadas <- list(title = 'AD-AS modellen',
                    x = 'produksjon, inntekt (Y)',
                    y = 'prisnivå (P)',
                    x0 = c(TeX('$Y_{0}=Y_{2}=Y^{N}$')),
                    y0 = c(TeX('$P_{0}=$P_{2}$')),
                    kurver = ldfkurver)


slabelsadas <- list(title = 'AD-AS modellen',
                    x = 'produksjon, inntekt (Y)',
                    y = 'prisnivå (P)',
                    x0 = c(TeX('$Y_{1}$')),
                    y0 = c(TeX('$P_{1}$')),
                    kurver = sdfkurver)

stadaslikevekt <- cgenmakrofigure(dfnumeric=dfadas,
                                  edfnumeric=stdfadas,
                                  variables = c(dfadas$varnavn),
                                  labt = llabelsadas,
                                  elabt = slabelsadas,
                                  scalejust = list(x=105, y=0))
stadaslikevekt
```

<!--



<button type="button"
onclick="document.getElementById('demo').innerHTML = Date()">
Click me to display Date and Time.</button>

<p id="demo"></p>

- 
1. $$Y = \frac{1}{1-c-R?}  \left [ \overline{C} -c\cdot \overline{T} - b\cdot \overline{i} + \overline{G}  \right ]$$
1. $$\frac{M}{P}=\kappa\cdot Y + h\cdot i$$
1. $$E = \frac{1+i^{*}}{1 + i} \text{ Flytende kursregime}$$
1. $$i = i^{*} \text{ Fastkursregime}$$

- IS-kurven under fast og flytende kurs

Generelt fører lavere rente til høyere produksjon.

Men multiplikatoren blir mindre ved en åpen økonomi, grunnet importlekkasje.

Helningen på kurven er slakere under flytende kurs enn med fast kurs. Det skyldes at lavere rente under flytende kurs fører til en depresiering av den nominelle og realvalutakursen, noe som forbedrer landets konkurranse evne og dermed fører til økt etterspørsel gjennom økt nettoeksport.

- LM modellen stigende under fast og horisontal under fast(?)

- Skiftanalyse (grafisk og verbalt)

Merk: P gir AS-kurven.

- Stabiliseringspolitikk (grafisk og verbalt)

Virkemidler: $G$, $T$ og $M/i$
 (Flytende) og
$G$,$T$ og($E$)
 (Fast kurs)
 

### Mundell-Fleming (IS-LM for en åpen økonomi) modellen 

- AS-kurven samme som under en lukket økonomi.
- AD-kurven er fallende ved at økt priser fører til lavere etterspørsel.
- Sentralt poeng med modellen – Selvkorrigerende mekanismer:

Fleksibilitet i P og korrekte prisforventninger Pe
på sikt, fører til at økonomien på sikt går tilbake til sin naturlige produksjons- og ledighetsnivå.
-->
-->
