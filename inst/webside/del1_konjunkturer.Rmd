---
#output: html_notebook
output:
  html_document:
    toc: true
    toc_depth: 4
---

# Del 1: Konjunktursvingninger

```{r include=FALSE}
library(MakroOEKB1115)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(latex2exp)

# Henter datasett
moltmacrousa <- MakroOEKB1115::moltmacrousa
unique(moltmacrousa$variable)

usadataI <- dplyr::filter(moltmacrousa, variable %in% c('unem', 'cunem', 'ggdp', 'inflation', 'cinflation', 'yinflation', 'cyinflation'))
fusadataI <- reshape2::dcast(usadataI, date + freqm ~ variable) %>% 
  dplyr::filter(freqm=='01', date >= '1948-01-01'& date < '2017-01-01')

okunusa <- qplot(data = fusadataI, x = ggdp, y = cunem, geom = c('point', 'smooth'), method='lm')
philipusa <- qplot(data = fusadataI, x = unem, y = yinflation, geom = c('point', 'smooth'), method='lm')

okunusag <- ggplot(data = fusadataI, aes(x = cunem, y = ggdp))  + geom_point() +  geom_smooth(method=lm, se=FALSE) + theme_classic() + labs(title = 'Okuns lov', subtitle = 'USA 1948-2016', x = 'Endring i arbeidsledigheten', y = c('Vekst i BNP (realpriser)'))

philipusag <- ggplot(data = fusadataI, aes(x = unem, y = cyinflation))  + geom_point() +  geom_smooth(method=lm, se=FALSE) + theme_classic() + labs(title = 'Phillips-kurven', subtitle = 'USA 1948-2016' ,x = 'Ledighetsrate', y = 'Endring i inflation')
```

```{r include=FALSE}
# Keyneskrysset
# Parameterverdier (Keyneskrysset)
lableg <- list(title= 'Keyneskrysset', x='Inntekt, produksjon (Y)', 
                                       y='Aggregert etterspørsel (AE)')

Yv <- 0:600
exoparval <- c(list(c_1 = 0.6, oC = 25, oG= 50, a = 30, i = 0.03, oI = 50, T = 10), list(Y=c(Yv)))
cexoparval <- c(list(c_1 = 0.6, oC = 25, oG= 50, a = 30, i = 0.03, oI = 75, T = 10), list(Y=c(Yv)))
dfkeynes <- dfgpmakro(Yv, exoparval, endr=0)
cdfkeynes <- dfgpmakro(Yv, cexoparval, endr=1)

labldf <- data.frame(labeling=c('45 grader', 'I', 'G + I', 'C+ I + G', 'Y = AE'), 
                     x=c(70, 560, 560, 560, 560), 
                     y = c(20, 60, 110, 490, 600),
                     col = c('black', rep(c('red'),1,4)))

clabldf <- data.frame(labeling=c("45 grader", "C+ I' + G", "Y = AE"), 
                     x=c(70, 560, 570), 
                     y = c(20, 510, 610),
                     col = c('black', rep(c('red'),1,2)))

keykryss <- gpdiamdoell(data = dfkeynes$dfmodell, variables = c("grad45v", "idv", "gdvpidv", "cdvpidvgdv"),
                           labt = lableg,
                           color = rep(c('black'),4),
                           labplassmon = labldf,
                           scalebreaksy = dfkeynes$scy,
                           scalebreaksx = dfkeynes$scx,
                           equisol = list(x = dfkeynes$yeae, y = dfkeynes$yeae))

ckeykryss <- gpdiamdoell(data = cdfkeynes$dfmodell, variables = c("grad45v","cdvpidvgdv"),
                           labt = lableg,
                           color = rep(c('black'), 2),
                           labplassmon = clabldf,
                           scalebreaksy = cdfkeynes$scy,
                           scalebreaksx = cdfkeynes$scx,
                           equisol = list(x = cdfkeynes$yeae, y = cdfkeynes$yeae))
```

## Grunnleggende bakgrunnkunnskaper 

### Stabiliseringsmål lukket økonomi

Intern balanse (lukke produksjonsgapet):

$$(Y-\overline{Y})=0$$
  
---

### Sentrale nasjonalregnskapstall
- Bruttonasjonalprodukt (GDP/BNP): Den samlede verdien av alle varer og tjenester som blir *produsert i landet* i løpet av et år
    - Nominelt BNP (LY) 
$$LY = PY$$
    - Reelt BNP (Y)
$$Y = LY/P $$

- Bruttonasjonalinntekt (GNP/BNI): Den samlede verdien av alle varer og tjenester som *landets innbyggere produserer* i løpet av et år

---

- Arbeidsledighetsrate:

$$u = 1-\frac{L}{N}$$

- Inflasjon: 

$$\pi = \frac{\Delta P}{P} =\frac{P_{t} - P_{t-1}}{P_{t-1}}$$

---

### Noen sentrale empiriske sammenhenger

#### Okuns lov: negativ sammenheng mellom endring i arbeidsledighet og vekst (eller endring i vekst)  i BNP (realpriser) 

```{r echo=FALSE}
okunusag 
```

---

#### Phillips-kurven: negativ sammenheng mellom arbeidsledighet og endring i inflasjon (eller inflasjon)

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Check for warnings
philipusag 
```

---

### Hva bestemmer aggregert produksjon (BNP)?
#### Kort sikt (0-3 år):
- Pga antagelsen om prisstivheter på kort sikt (uendret lønn og produktpriser), vil  samlet etterspørsel ($AE$) bestemme BNP ($Y$)
- Vi legger dette til grunn i enkel Keynes, IS-LM,  og Mundell-Fleming modellen (del I og del III)

#### Mellomlang sikt (5-10 år):
- Tilgangen på innsatsfaktorene arbeidskraft ($L$), teknologi ($A$) og kapital ($K$) bestemmer BNP ($Y$)
- Langsiktig likevektsbetingelse for AD-AS modellen (del I)

---

#### Lang sikt (10-50 år):
- Teknologisk framgang ($a$), kapitalakkumulasjon ($\Delta K$) og befolkningsvekst ($n$) bestemmer BNP ($Y$)
- Hovedresultatet fra Solow-modellen (del II)

---

## Enkel Keynes-modell 

- Likevekt i godemarkedet (varer og tjenester)

### Aggregert etterspørsel (AE)
(@AE) $$AE \equiv  C + I + G$$

### Markeder i likevekt: Godemarkedet (varer og tjenester)
(@MG) $$Y = AE \equiv  C + I + G$$

---

### Adferdsligninger

#### Husholdninger

(@CH) $$C =  \overline{C} + c(Y - T)$$

Hvor $0<c<1$ og $\overline{C}>0$

#### Bedrifter
(@ID) $$I = \overline{I} - b\cdot i$$

Hvor $\overline{I}>0$ og $b>1$ og 

#### Sentralbanken
(@CB) $$i = \overline{i}$$

Hvor $\overline{i} >= 0$

---

#### Offentlige myndigheter
(@OMG) $$G = \overline{G}$$ 

og

(@OMT) $$T = \overline{T}$$ 


---

### Løsning av modellen:
Setter adferdsligningene (@CH) - (@OM) inn i likevekstbetingelsen for godemarkedet (@MG)

$$Y = \overline{C} + c(Y - \overline{T}) + \overline{I} - b\cdot \overline{i} + \overline{G}$$

Løser modellen mhp. på Y (godemarkedet) 

(@LBL) $$Y = \frac{1}{1-c}  \left [ \overline{C} -c\cdot \overline{T} - b\cdot \overline{i} + \overline{G}  \right ]$$

Endogene variabler (bestemt av modellen): $Y$ 

Eksogene variabler (bestemt utenfor modellen): $\overline{C}, \overline{T}, \overline{i}, \overline{I}, \overline{G}$

Parametre: $c, b$

---

-  Grafisk framvisning 

```{r echo=FALSE}
keykryss
```

---

### Komparativ statikk (analyse fra en likevekt til en annen): 

Økte investeringer ('animal spirits') $\Delta{\overline{I}}>0$

- **F**ormelt:
(@KSI) $$\Delta Y = \frac{1}{1-c}\Delta  \overline{I}>0 \text{ eller } \frac{\Delta Y}{\Delta  \overline{I} } = \frac{1}{1-c}>1$$

- **V**erbalt (dynamisk tolkning utenfor modellen):

Økte investeringer $\rightarrow$ økt produksjon $\rightarrow$ initierer en multiplikatoreffekt: $\rightarrow$ økt disponibel inntekt $\rightarrow$ økt konsum $\rightarrow$ økt produksjon osv.

---

- **G**rafisk:

```{r echo=FALSE}
ckeykryss
```

---

### Stabiliseringspolitikk

Reduserte offentlige utgifter $\Delta G < 0$

(@KSISG) $$\Delta Y = \frac{1}{1-c}  \left [ \Delta \overline{I} + \Delta \overline{G} \right ]$$

Dersom vi lar $\Delta \overline{I} = - \Delta \overline{G} > 0 \Rightarrow \Delta Y = 0$ (dvs. intern balanse)

- Merk: Det politiske systemet i de fleste land innebygd iboende tregheter tilknyttet budsjettendringer. Dette gjør finanspolitikk vanskelig å implementere som konjunkturstabiliserende virkemiddel, fordi treghetene gjør at man responderer for sent sett i forhold til konjunktursituasjonen

---

### Øvelse

Redusert rentenivå $\Delta{\overline{i}}<0$

- **F**ormelt:

- **G**rafisk (Y, i plan):

- **V**erbalt (tolkning utenfor modellen):

---

## IS-LM modellen

```{r include=FALSE}
qplot()
```

### Markeder i likevekt: Gode- og pengemarkedet
(@mgo) $$Y = AE$$ 

(@mpe) $$L_{m} = M/P$$

### Adferdsligninger

#### Husholdninger
Bestemmer pengeetterspørselen (realverdi)
(@mpe) $$L_{m} = kY -hi$$
Hvor $k>0$ og $h>0$

#### Sentralbanken
$$M = \overline{M} $$
#### Offentlige myndighter

$$T = tY $$
Hvor $t$ er prosentvis skattesats

### Løsning av modellen:
#### Godemarkedet (samme løsningsmetodikk som under enkel Keynes-modell)
$$Y = \frac{1}{1-c}  \left [ \overline{C} -c\cdot \overline{T} - b\cdot \overline{i} + \overline{G}  \right ]$$

#### Pengemarkedet
Bestemmer pengetilbudet
$$kY -hi = \overline{M}/P$$

### IS-LM diagrammet
**Formelt**

IS-kurven finner vi ved å differensiere likevektsbetingelsen for godemarkedet mph. Y og i:

$$\Delta Y = (\frac{-b}{1-c})\cdot \Delta \overline{i}<0$$

LM-kurven finner vi ved å differensiere likevektsbetingelsen for pengemarkedet mhp. Y og i:

$$k\Delta Y -h\Delta i = 0 \Leftrightarrow  \frac{\Delta Y}{\Delta i} = \frac{h}{k} > 0 $$
**Grafisk**
```{r}
library(ggplot2)
qplot()
```

### Komparativ statikk: 

- Økning i pengemengden

- (F)ormelt

- (G)rafisk

- (V)erbal tolkning utenfor modellen

### Stabiliseringspolitikk

#### Øvelse

## AS-kurven

## Bakgrunnskunnskap om åpen Økonomi

### Stabiliseringsmål for en åpen økonomi
1. Intern balanse (lukke produksjonsgapet)
1. Ekstern balanse (holde utenlandsgjelden på et rimelig nivå)

### Utenriksregnskapet

## Mundell-Fleming modellen (IS-LM for en åpen økonomi)

### Markeder i likevekt: Gode-, penge- og valutakursmarkedet

### Adferdslikninger

#### Husholdninger

#### Bedrifter

#### Sentralbanken

#### Offentlige myndigheter

### Løsning av modellen fast kurs

### Komparativ statikk

### Stabiliseringspolitikk

### Løsning av modellen flytende kurs

### Komparativ statikk

### Stabiliseringspolitikk

### Øvelse

## AD-AS for en åpen økonomi

### Markeder i likevekt: Gode-, penge-, or arbeids- og valutakursmarkedet

### Adferdslikninger

#### Husholdninger

#### Bedrifter

#### Sentralbanken

#### Offentlige myndigheter

### Løsning av modellen fast kurs

### Komparativ statikk

### Stabiliseringspolitikk

### Løsning av modellen flytende kurs

### Komparativ statikk

### Stabiliseringspolitikk
