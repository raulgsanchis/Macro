---
output: html_notebook
---

<!--
# Del I: Konjunktursvingninger
<img id='grede' src="bilder/cycles.jpg" height="75px" width="300px" />
<img id='grere' src="bilder/money.jpg" height="75px" width="300px" />

> Long run is a misleading guide to current affairs. In the long run we are all dead.
- Keynes

-->

```{r include=FALSE}
library(MakroOEKB1115)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(latex2exp)

# Henter datasett
moltmacrousa <- MakroOEKB1115::moltmacrousa
unique(moltmacrousa$variable)

usadataI <- dplyr::filter(moltmacrousa, variable %in% c('unem', 'cunem', 'ggdp', 'inflation', 'cinflation', 'yinflation', 'cyinflation'))
fusadataI <- reshape2::dcast(usadataI, date + freqm ~ variable) %>% 
  dplyr::filter(freqm=='01', date >= '1948-01-01'& date < '2017-01-01')

okunusa <- qplot(data = fusadataI, x = ggdp, y = cunem, geom = c('point', 'smooth'), method='lm')
philipusa <- qplot(data = fusadataI, x = unem, y = yinflation, geom = c('point', 'smooth'), method='lm')

okunusag <- ggplot(data = fusadataI, aes(x = cunem, y = ggdp))  + geom_point() +  geom_smooth(method=lm, se=FALSE) + theme_classic() + labs(title = 'Okuns lov', subtitle = 'USA 1948-2017', x = 'Endring i arbeidsledigheten', y = c('Vekst i BNP (realpriser)'))

philipusag <- ggplot(data = fusadataI, aes(x = unem, y = cyinflation))  + geom_point() +  geom_smooth(method=lm, se=FALSE) + theme_classic() + labs(title = 'Phillips-kurven', subtitle = 'USA 1948-2017' ,x = 'Ledighetsrate', y = 'Endring i inflation')

# Keyneskrysset
# Henter Jupyter data
keynesequ <- rjson::fromJSON(file=paste0(devtools::as.package(".")$path,'/inst/webside/jupyter/keynesequ.json'))

# Parameterverdier
exoparval <- list(c_1=0.7, oC = 50, oG= 50, a=30, i = 0.03, oI = 30)
dexoparval <- list(c_1=0.7, oC = 50, oG= 50, a=30, i = 0.03, oI = 35)

# Variabler som endrer seg
Yv <- c(0:1000)

# Implikasoner
grad45v <- 0:rev(Yv)[1]
cdv <- eval(parse(text=keynesequ$CD),c(exoparval,list(Y=Yv)))
idv <- eval(parse(text=keynesequ$ID),c(exoparval,list(Y=Yv)))
gdv <- eval(parse(text=keynesequ$GD),c(exoparval,list(Y=Yv)))

# Datatabell (format)
dfkeykryss <- data.frame(x = Yv, grad45 = grad45v, cd = cdv, id = idv, gd = gdv) %>% 
  reshape2::melt(id.vars = c("x")) 
  #%>%dplyr::mutate(kat=substring(variable,6,6))

# Labeling
## Main
lablist <- list(x='Inntekt', y = 'AE (aggregert etterspørsel)')
## I plottet
lablistdf <- data.frame(label=c('ABC'),x=c(1),y=c(1))


# Ggplot2 (funksjon senere)
## Henter datasettet
datainp <- dplyr::filter(dfkeykryss, variable %in% c('grad45', 'cd', 'gd'))
## Komponent1
keykg <- ggplot(data = datainp, aes(x = x, y = value, color = factor(variable))) + 
  geom_line() +
  geom_point(aes(x=0, y=0)) +
  geom_segment(aes(x = 500, y = 0, xend = 500, yend = 100), lty = 2) +
  #geom_text(aes(x=500, y=500, label=TeX('$\theta$')), parse=TRUE) +
  scale_x_continuous(name=lablist$x, breaks = c(400), labels = c(TeX('$Y_{0}$')) ) +
  scale_y_continuous(name=lablist$y, breaks = c(400), labels = c('def') ) +
  labs(title= 'Keyneskrysset') + theme_classic() +
  theme(legend.position="none") +
  coord_cartesian()
```

## Grunnleggende bakgrunnkunnskaper og enkel Keynes modell (lukket økonomi)

### Stabiliseringsmål lukket økonomi

Intern balanse (lukke produksjonsgapet):

$$(Y-\overline{Y})=0$$
  
---

### Sentrale nasjonalregnskapstall
- Bruttonasjonalprodukt (GDP/BNP): Den samlede verdien av alle varer og tjenester som blir produsert i landet i løpet av et år
    - Nominelt BNP (LY) 
$$LY = PY$$
    - Reelt BNP (Y)
$$Y = PY/P$$

- Bruttonasjonalinntekt (GNP/BNI): Den samlede verdien av alle varer og tjenester som landets innbyggere produserer i løpet av et år

---

- Arbeidsledighetsrate:

$$u = 1-\frac{L}{N}$$

- Inflasjon: 

$$\pi = \frac{P_{1} - P_{0}}{P_{0}}$$

---

### Noen sentrale empiriske sammenhenger

#### Okuns lov: negativ korrelasjon mellom endring i arbeidsledighet og vekst (eller endring)  BNP (realpriser) 

```{r echo=FALSE}
okunusag 
```

---

#### Phillips-kurven: sammenheng mellom arbeidsledighet og endring i inflasjon (eller inflasjon)

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Check for warnings
philipusag 
```

---

### Hva bestemmer aggregert BNP?
#### Kort sikt (0-3 år):
- Pga av antagelsen om at produktpriser og lønninger ikke endrer seg på kort sikt, vil  samlet etterspørsel ($AE$) bestemmer BNP ($Y$)
- Vi legger dette til grunn i enkel Keynes, IS-LM,  og Mundell-Fleming modellen (del I og del III)

#### Mellomlang sikt (5-10 år):
- Tilgangen på innsatsfaktorene arbeidskraft ($L$), teknkologi ($A$) og kapital ($K$) bestemmer BNP ($Y$)
- Langsiktig likevekstbetingelse for AD-AS modellen (del I)

---

#### Lang sikt (10-50 år):
- Teknologisk framgang ($a$), kapitalakkumalasjon ($\Delta K$) og befolkningsvekst ($n$) bestemmer BNP ($Y$)
- Hovedresultatet fra Solow modellen (del II)

---

### Enkel Keynes-modell 

- Likevekt i godemarkedet (varer og tjenester)

#### Aggregert etterspørsel (AE)
$$AE \equiv  C + I + G$$

#### Markeder i likevekt: Godemarkedet (varer og tjenester)
$$Y = AE$$

---

#### Husholdninger
$$C =  \overline{C} + c(Y - T)$$

Hvor $0<c<1$ og $\overline{C}>0$

#### Bedrifter
$$I = \overline{I} - b\cdot i$$

Hvor $\overline{I}>0$ og $b>1$ og 

#### Sentralbanken
$$i = \overline{i}$$

Hvor $\overline{i} \geqslant 0$

---

#### Offentlige myndigheter
$$G = \overline{G}$$ og $$T = \overline{T}$$

---

#### Løsning av modellen:
Setter adferdslikningene inn i likevekstbetingelsen for godemarkedet

$$Y = \overline{C} + c(Y - T) + \overline{I} - b\cdot i + \overline{G}$$

Løser modellen mhp. på Y (godemarkedet) 

$$Y = \frac{1}{1-c}  \left [ \overline{C} - T - b\cdot \overline{i} + \overline{G}  \right ]$$

Endogene variabler: $Y$ 

Eksogene variabler: $\overline{C}, \overline{T}, \overline{i}, \overline{I}, \overline{G}$

Parametre: $c, b$

---

-  Grafisk framvisning 

```{r echo=FALSE}
keykg
```

---

#### Komparativ statikk (analyse fra en likevekt til en annen): 

Økte investeringer ('animal spirits') $\Delta{\overline{I}}>0$

- **F**ormelt:

$$\Delta Y = \frac{1}{1-c}\Delta  \overline{I}>0$$

- **V**erbalt (tolkning utenfor modellen):

Økte investeringer $\rightarrow$ økt produksjon $\rightarrow$ multiplikatoreffekt: $\rightarrow$ økt disponibel inntekt $\rightarrow$ økt konsum $\rightarrow$ økt produksjon etc.

---

- **G**rafisk:

```{r echo=FALSE}
keykg
```

---

#### Stabiliseringspolitikk

Reduserte offentlige utgifter $\Delta G < 0$

$$Y = \frac{1}{1-c}  \left [ \Delta \overline{I} + \Delta \overline{G} \right ]$$

Dersom vi lar $\Delta \overline{I} = - \Delta \overline{G} > 0 \Rightarrow \Delta Y = 0$ (dvs. intern balanse)

I praksis kan det som regel være vanskelig å benytte finanspolitikk som konjunkturstabiliserende virkemiddel, siden det politiske systemet som oftest innehar innebygde tregheter tilknyttet endringer i finanspolitikken (eks. må godkjennes av Storting og regjering)

---

#### Øvelse

Redusert rentenivå $\Delta{{i}}<0$

- **F**ormelt:

- **G**rafisk (Y, i plan):

- **V**erbalt (tolkning utenfor modellen):

<!--

### IS-LM modellen: likevekt i gode- og pengemarkedet

#### Husholdninger

#### Bedrifter

#### Sentralbanken

#### Offentlige myndigheter

#### Markeder i likevekt: Gode- og pengemarkedet

#### Løsning av modellen:
1. Setter inn for x, y

1. Løser modellen mhp. på Y (godemarkedet) 

1. Lister opp de endogende og eksogene variablene

1. Grafisk framvisning ('Keynesian cross')

#### Komparativ statikk (FGV): 

- Økning i pengemengden

- (F)ormelt

- (G)rafisk

- (V)erbal tolkning utenfor modellen

#### Stabiliseringspolitikk

#### Øvelse

### AD-AS modellen: likevekt i gode-, penge- og arbeidsmarkedet

#### Husholdningene

#### Bedriftene 

#### Likevekt i arbeidsmarkedet og AS-kurven

#### Markeder i likevekt: Gode, penge, og arbeidsmarkedet

#### Løsning av modellen:
1. Setter inn for x, y

1. Løser modellen mhp. på Y (godemarkedet) 

1. Lister opp de endogene og eksogene variablene

1. Grafisk framvisning ('Keynesian cross')

#### Komparativ statikk (FGV): 

- Økning i pengemengden

- (F)ormelt

- (G)rafisk

- (V)erbal tolkning utenfor modellen

#### Stabiliseringspolitikk

#### Øvelse

## Åpen Økonomi

### Stabiliseringsmål for en åpen økonomi
1. Intern balanse (lukke produksjonsgapet)
1. Ekstern balanse (holde utenlandsgjelden på et rimelig nivå)

### Utenriksregnskapet

### Mundell-Fleming modellen (IS-LM for en åpen økonomi): likevekt i gode, penge- og valutakursmarkedet

#### Husholdninger

#### Bedrifter

#### Sentralbanken

#### Offentlige myndigheter

#### Markeder i likevekt: Gode-, penge- og valutakursmarkedet

#### Løsning av modellen:
1. Setter inn for x, y

1. Løser modellen mhp. på Y (godemarkedet) 

1. Lister opp de endogende og eksogene variablene

1. Grafisk framvisning ('Keynesian cross')

#### Komparativ statikk (GV): 

- Økte investeringer ('animal spirits') $\Delta{I}>0$

- (F)ormelt

- (G)rafisk

- (V)erbalt

#### Stabiliseringspolitikk

- Reduserte offentlige utgifter $\Delta G < 0$

Lag

#### Øvelse

### AD-AS: likevekt i gode, penge, valuta- og arbeidsmarkedet

#### Markeder i likevekt: Gode, penge, arbeids, og valutakursmarkedet

#### Løsning av modellen:
1. Setter inn for x, y

1. Løser modellen mhp. på Y (godemarkedet) 

1. Lister opp de endogene og eksogene variablene

1. Grafisk framvisning ('Keynesian cross')

#### Komparativ statikk (FGV): 

- Økning i pengemengden

- (F)ormelt

- (G)rafisk

- (V)erbal tolkning utenfor modellen

#### Stabiliseringspolitikk

#### Øvelse

<!--
Del 1: Økonomiske svingninger på kort sikt
Grunnleggende bakgrunnskunnskap 
	Mål på aggregert produksjon: BNP
(1) Verdien til alle sluttgodene (varer og tjenester) som blir produsert i en bestemt tidsperiode.
(2) Summen av all merverdi for en bestemte tidsperiode.
(3) Summen av all inntekt for en bestemte tidsperiode.
	Nominell BNP (LY)
LY=PY
	Reel BNP (Y)
   Y=LY/P
	Ledighet (U) og ledighetsrate (u)
U=L-N hvor N antall i arbeid og U antall utenfor arbeid
u=U/L=(N-L)/L=N/L-1
	Inflasjon (π)
 π=ΔP/P=(P_t-P_(t-1))/P_(t-1) 
	Okuns lov:
Negativ korrelasjon mellom vekst i produksjonen (BNP) og endring i ledighetsraten. 
	Phillips-kuven:	
Negativ korrelasjon mellom endring i inflasjon og ledighetsraten.
	Hva bestemmer aggregert BNP?
	Kort sikt: Etterspørsel bestemmer produksjonen (pga. stive stive priser)
Mellomlang sikt: Tilgangen på innsatsfaktorer (arbeidskraft, teknologi og kapital) bestemmer etterspørselen.
	Lang sikt: Teknologisk framgang og kapital akkumulasjon (avhenger av sparing, befolkningsvekst (fødselsrater + nettoinnvandring)).
Likevekt i vare-  og tjenestemarkedet 
	 Aggregert etterspørsel (Z) i en lukket økonomi    
Z ≡ C+I+G 
	Hvor vi postulerer følgene adferdlikninger
C= C ̅-c(Y-T)
I =I ̅-b∙i
og likevektsbetingelsen
Y=Z
	Løser denne mhp på Y gir oss IS-likningen (kombinasjoner av i og Y som er forenlig med likevekt i varemarkedet)
Y=1/(1-c) [C ̅+cT+I ̅-b∙i+G]
	Skiftanalyse (matematisk, figur, og verbalt): Endring i ΔY som følge av en økning i  Δ ̅I 
	Matematisk 
ΔY=  1/(1-c)  Δ I ̅>0 eller (Δ Y)/(Δ I ̅ )=  1/(1-c)  >0
	Verbalt  (skisse – utenfor modellen)
Økte investeringer  økt produksjon  multiplikatoreffekt:    økt disponibel inntekt 
 økt konsum  økt produkson etc.
	Stabiliseringspolitikk: ∆G<0 
ΔY=1/(1-c) [Δ I ̅+ΔG]
Hvor vi sørger for at ΔG=Δ ̅I □(⇒)  ΔY=0 

Likevekt i pengemarkedet 
Ser foreløpig kun på utvendige penger M=M_0 (M_1): Sedler og mynt pluss bankenes innskuddskontoer i sentralbanken. Dette nivået blir bestemt av sentralbanken.
	Etterspørsel etter penger.
M^D (Y┬((∓)),i┬((-)))  
	Likevekt i pengemarkedet: 
M/P=M^D (Y,i)
	Sentralbanken bestemmer hva som skjer i pengemarkedet ved
	Endre tilbudet av penger (vanlig tidligere) eller (2) å endre rentenivået (vanlig i dag).
IS-LM modellen for en lukket økonomi: Gode- og pengemarkedet i likevekt
	Modellen 
Y=1/(1-c) [C ̅+cT+I ̅-b∙i+G] ∶Varemarkedet
M/P=M^D (Y,i):Pengemarkedet
Grafisk tegning bestemmer her Yog i samtidig 
	Skiftanalyse (grafisk og verbalt)
Merk: P gir AS-kurven.
	Stabiliseringspolitikk (grafisk og verbalt)
Virkemidler: G,T og M/i


AD-AS modellen for en lukket økonomi: Gode, penge og arbeidsmarkedet i likevekt
	Husholdningene: Tilbyr arbeid
W=P^e F(u┬((-)),z┬((+)))
	Bedrifter: Etterspør arbeidskraft og tilbyr produktet i et marked med monopolistisk konkurranse
 Y=AN
	
P=(1+μ)W
	Ledighet
u =U/L=(L-N)/L  =1-N/L=1-Y/AL
	Kombinere dett gir oss AS-kurven (verdier av P og Y som gir likevekt i arbeidsmarkedet)
P=(1+μ) P^e F(1-Y/AL,z)
	AD-AS-modellen  
Y=1/(1-c) [C ̅+cT+I ̅-b∙i+G] ∶Varemarkedet
M/P=M^D (Y,L):Pengemarkedet
P=(1+μ) P^e F(1-Y/AL,z):Arbeidsmarkedet
Merk: P=P^e⇒Y=Y^n=u=u^n Naturlige produksjons- og ledighetsnivået,
Grafisk tegning bestemmer her P, Yog i samtidig 
	Skiftanalyse (grafisk og verbalt)
	Stabiliseringspolitikk (grafisk og verbalt)
Virkemidler: G,T og M/i
	Sentral poeng med modellen – Selvkorrigerende mekanismer:
Fleksibilitet i P og korrekte prisforventninger P^e på mellomlang sikt, fører til at økonomien går tilbake til sitt naturlige produksjons- og ledighetsnivå.  
IS-LM modellen for en åpen økonomi: Gode-, penge- og valutakursmarkedet i likevekt 
	Tre fundamentale endringer:
(1) Handel med utlandet. 
(2) Internasjonale finansmarkeder. 
(3) Fast eller flytende kurs.

Z=C+I+G+NX; 
NX = X-R*IM
CU+CA=0
CU=Driftsregnskapet: Nettoeksport, Nettofinansinntekter(aksjer og obligasjoner), Nettoverføringer
CA=Kapitalregnskapet: Nettoendringer i fordringer og gjeld ovenfor utlandet
	To stabiliseringsmål: 
(I) Intern balanse (produksjon lik naturlig produksjonsnivå).
(II) Ekstern balanse (rimelig nivå på utenlandsgjelden).
	(1) Handel med utlandet (avhenger blant annet av relative prisnivået mellom innenlandske og utenlandske varer)
Realvalutakursen: R=(EP^*)/P  
	E: Pris per enhet av utenlandsk (innenlandsk) valuta E  (1/E)
	Postulerer følgende sammenhenger for handelsbalansen
X=X(R┬((∓)),(Y^*)┬((∓)))
IM = IM(R┬((-)),Y┬((∓)))
	NX(R,Y,Y*)= X(R,Y*)-R∙IM(R,Y)
Antar at dNX/dR > 0 (men dette kan ta litt tid)

	(2) internasjonale finansmarkeder (renteparitetsbetingelsen)

(1+i_(t+1))=((1+i_(t+1)^* ) E_(t+1)^e)/(E_t)
	(3) Fast eller flytende kurs
Flytende:

E=(1+i*)/(1+i) E^e  
Fast: (troverdig  ⇒E=E^e):

	
i=i^*

	Modellen 
Y=1/(1-c+Rb_2 ) [C ̅+cT+I ̅-b∙i+G] ∶Varemarkedet.
M/P=M^D (Y,L):Pengemarkedet.

E=(1+i*)/(1+i) E^e: Flytende-kursregime.

i=i^*: Fast-kursregime.

	IS-kurven under fast og flytende kurs
Generelt fører lavere rente til høyere produksjon.
Men multiplikatoren blir mindre ved en åpen økonomi, grunnet importlekkasje.
Helningen på kurven er slakere under flytende kurs enn med fast kurs. Det skyldes at lavere rente under fast kurs fører til en depresiering av den nominelle og realvalutakursen, noe som forbedrer landets konkurranse evne og dermed fører til økt etterspørsel gjennom økt nettoeksport.
	LM modellen samme som tidligere.
	Skiftanalyse (grafisk og verbalt)
Merk: P gir AS-kurven.
	Stabiliseringspolitikk (grafisk og verbalt)
Virkemidler: G,T og M/i (Flytende) og G,T og (E) (Fast kurs)
AD-AS modellen for en åpen økonomi
	AS-kurven samme som under en lukket økonomi.
	AD-kurven er fallende ved at økt priser fører til lavere etterspørsel.
	Sentral poeng med modellen – Selvkorrigerende mekanismer:
Fleksibilitet i P og korrekte prisforventninger P^e på sikt, fører til at økonomien på sikt går tilbake til sin naturlige produksjons- og ledighetsnivå.
-->
